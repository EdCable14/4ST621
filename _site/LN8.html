<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Adam Cabla">

<title>4ST621 - Stochastic convergences</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">4ST621</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./Course_Intro.html" rel="" target="" aria-current="page">
 <span class="menu-text">Course Introduction</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./LN1.html">Probability Theory</a></li><li class="breadcrumb-item"><a href="./LN8.html">Stochastic convergences</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Course_Intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Probability Theory</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./LN1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Basics of Probability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./LN2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Random Variable</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./LN3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Characteristics of Random Variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./LN4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Random Vectors</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./LN5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Selected Discrete Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./LN6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Selected Continuous Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./LN7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Two Selected Multivariate Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./LN8.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Stochastic convergences</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Mathematical Statistics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./LN9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sampling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./LN10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Point estimates</span></a>
  </div>
</li>
          <li class="sidebar-item">
 <span class="menu-text">LN11.qmd</span>
  </li>
          <li class="sidebar-item">
 <span class="menu-text">LN12.qmd</span>
  </li>
          <li class="sidebar-item">
 <span class="menu-text">LN13.qmd</span>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#convergence-in-probability-almost-sure-convergence" id="toc-convergence-in-probability-almost-sure-convergence" class="nav-link" data-scroll-target="#convergence-in-probability-almost-sure-convergence">Convergence in probability &amp; almost sure convergence</a>
  <ul class="collapse">
  <li><a href="#bernoullis-law" id="toc-bernoullis-law" class="nav-link" data-scroll-target="#bernoullis-law">Bernoulli´s law</a></li>
  <li><a href="#knichins-law" id="toc-knichins-law" class="nav-link" data-scroll-target="#knichins-law">Knichin´s law</a></li>
  <li><a href="#kolmogorovs-law" id="toc-kolmogorovs-law" class="nav-link" data-scroll-target="#kolmogorovs-law">Kolmogorov´s law</a></li>
  </ul></li>
  <li><a href="#convergence-in-distribution" id="toc-convergence-in-distribution" class="nav-link" data-scroll-target="#convergence-in-distribution">Convergence in distribution</a>
  <ul class="collapse">
  <li><a href="#de-moivre-laplace-central-limit-theorem" id="toc-de-moivre-laplace-central-limit-theorem" class="nav-link" data-scroll-target="#de-moivre-laplace-central-limit-theorem">de Moivre-Laplace central limit theorem</a></li>
  <li><a href="#lindenberg-lévy-central-limit-theorem" id="toc-lindenberg-lévy-central-limit-theorem" class="nav-link" data-scroll-target="#lindenberg-lévy-central-limit-theorem">Lindenberg-Lévy central limit theorem</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Stochastic convergences</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Adam Cabla </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>We are finally getting to the last part of the probability part of our course, 4ST621. Here, a short discussion of and information on the basic stochastic convergences is provided. These convergences tell the story of how, under some circumstances, randomly generated values and distributions of some statistics converge to their limit, which are theoretical characteristics and probability distributions.</p>
<p>In frequentist statistics, this knowledge is used to make generalising claims (inferences) about the underlying characteristics of the data-generating process.</p>
</section>
<section id="convergence-in-probability-almost-sure-convergence" class="level2">
<h2 class="anchored" data-anchor-id="convergence-in-probability-almost-sure-convergence">Convergence in probability &amp; almost sure convergence</h2>
<p>Standard <em>deterministic</em> convergence usually claims something about the limit of a sequence for an increasing value of the variable, e.g.</p>
<p><span class="math display">\[
\frac{1}{n} \xrightarrow{n\to\infty}0
\]</span></p>
<p><span class="math display">\[\lim_{n\to\infty}\left(\frac{1}{n}\right)=0\]</span></p>
<p>In <em>stochastic</em> convergences, our limit is usually put upon some probability, not the variable’s value. For convergence <em>in probability</em>, we start with a sequence of random variables <span class="math inline">\(X_n\)</span> and claim its convergence in probability to its limit <span class="math inline">\(X\)</span>:</p>
<p><span class="math display">\[
X_n\xrightarrow{n\to\infty;P}X
\]</span></p>
<p><span class="math display">\[
p\lim(X_n)=X
\]</span></p>
<p>The definition of <em>in probability</em> convergence is done after specifying some small positive constant <span class="math inline">\(\varepsilon&gt;0\)</span></p>
<p><span class="math display">\[
P(|X_n-X|&lt;\varepsilon)\xrightarrow{n\to\infty}1
\]</span></p>
<p>or inversely</p>
<p><span class="math display">\[
P(|X_n-X|&gt;\varepsilon)\xrightarrow{n\to\infty}0
\]</span></p>
<p>The first formulation stresses that <strong>the</strong> <strong>probability</strong> of absolute deviation of a sequence from its limit being up to the constant <span class="math inline">\(\varepsilon\)</span> increases; that is, the sequence converges <em>long-term</em>. The second formulation stresses that <strong>the probability</strong> of such deviation or larger is becoming smaller. That can be translated as saying that the probability of an <em>unusual</em> outcome decreases.</p>
<section id="bernoullis-law" class="level3">
<h3 class="anchored" data-anchor-id="bernoullis-law">Bernoulli´s law</h3>
<p>The first use of the in probability convergence is Bernoulli´s first formulation of the weak law of large numbers: Let <span class="math inline">\(X_1,X_2,...,X_n\)</span> be a sequence of independent random variables with Bernoulli distribution, <span class="math inline">\(X_i\sim Be(\pi)\)</span>.</p>
<p>Let a sequence of relative frequencies be calculated from these random variables that is, <span class="math inline">\(P_n=\frac{\sum_{i=1}^{n}(X_i)}{n}\)</span>. This sequence will converge in probability to the <span class="math inline">\(\pi\)</span>.</p>
<p><span class="math display">\[
P_n \xrightarrow{n\to\infty;P}\pi
\]</span></p>
<p>This is akin to saying that the larger the sample size, the closer the relative frequency is to the underlying probability <em>in probability</em>.</p>
</section>
<section id="knichins-law" class="level3">
<h3 class="anchored" data-anchor-id="knichins-law">Knichin´s law</h3>
<p>Let <span class="math inline">\(X_1,X_2,...,X_n\)</span> be a sequence of independent identically distributed random variables with any distribution with finite variance, <span class="math inline">\(X_i\sim ?(E(X),Var(X))\)</span>.</p>
<p>Let a sequence of means be calculated from these random variables, that is, <span class="math inline">\(\overline{X_n}=\frac{\sum_{i=1}^{n}(X_i)}{n}\)</span>. This sequence will converge in probability to the expected value <span class="math inline">\(E(X)\)</span>.</p>
<p><span class="math display">\[ \overline{X_n} \xrightarrow{n\to\infty;P}E(X) \]</span></p>
<p>This is akin to saying that the larger the sample size, the closer the mean is to the underlying expected value <em>in probability</em>.</p>
</section>
<section id="kolmogorovs-law" class="level3">
<h3 class="anchored" data-anchor-id="kolmogorovs-law">Kolmogorov´s law</h3>
<p>So far, we have used <em>in</em> <em>probability</em> convergence. However, mathematical development in the early 20th century led to a different type of <em>stochastic</em> convergence, defined and proven for the two previous convergences, called <em>almost sure</em> (<em>a.s.</em>) convergence. This convergence is defined as</p>
<p><span class="math display">\[
P\left(\lim_{n\to\infty}X_n=X\right)=1
\]</span></p>
<p>In this type of convergence, the probability is not converging to 1; rather, the probability of convergence at some step <em>n</em> is 1. This claim is stronger than the previous one and leads to the so-called strong law of large numbers, also known as Kolmogorov´s law:</p>
<p><span class="math display">\[ \overline{X_n} \xrightarrow{n\to\infty;a.s.}E(X) \]</span></p>
<p>This fundamental theoretical development, along with the ease of use, basically cemented the frequentist statistic as the default inferential procedure for more than half a century.</p>
</section>
</section>
<section id="convergence-in-distribution" class="level2">
<h2 class="anchored" data-anchor-id="convergence-in-distribution">Convergence in distribution</h2>
<p>Convergences in probability or almost surely state the limit value of a sequence of random variables. Convergence in distribution state the limit <strong>distribution</strong> of values of a sequence of random variables.</p>
<p>Let <span class="math inline">\(X_1,X_2,...,X_n\)</span> be a sequence of independent identically distributed random variables with any distribution with finite variance, <span class="math inline">\(X_i\sim ?(E(X),Var(X))\)</span>, and cumulative distribution function <span class="math inline">\(F(x)\)</span>.</p>
<p>From this sequence of random variables, let´s have a sequence of cumulative distribution functions <span class="math inline">\(F_n(x)\)</span>. Convergence in distribution states that this sequence of <span class="math inline">\(F_n(x)\)</span> converges to a specific <em>underlying</em> cumulative distribution function <span class="math inline">\(F(x)\)</span>.</p>
<p><span class="math display">\[
F_n(x)\xrightarrow{n\to\infty;D}F(x)
\]</span></p>
<p>One of the results is that the larger the dataset, the closer the <em>empirical</em> cumulative distribution function (cumulative relative frequencies) is to the <em>theoretical</em> cumulative distribution function of a generating process.</p>
<section id="de-moivre-laplace-central-limit-theorem" class="level3">
<h3 class="anchored" data-anchor-id="de-moivre-laplace-central-limit-theorem">de Moivre-Laplace central limit theorem</h3>
<p>This theorem states the limit distribution of binomial distribution: Let <span class="math inline">\(X_1,X_2,...,X_n\)</span> be a sequence of independent random variables with Bernoulli distribution, <span class="math inline">\(X_i\sim Be(\pi)\)</span>.</p>
<p>Let a sequence of summations be calculated from these random variables, that is, <span class="math inline">\(M_n=\sum_{i=1}^{n}(X_i)\)</span>. This summation follows binomial distribution but also converges <em>in distribution</em> to the normal distribution:</p>
<p><span class="math display">\[
M_n\sim Bi(n,\pi)\xrightarrow{n\to\infty;D}N \left(n\pi,\sqrt{n\pi(1-\pi)}\right)
\]</span></p>
<p>We can make a similar claim about a sequence of means by linear transformation.</p>
<p><span class="math display">\[\overline{X_n}=P=\frac{\sum_{i=1}^{n} X_i}{n}\xrightarrow{n\to\infty;D}N \left(\pi,\sqrt{\frac{\pi(1-\pi)}{n}} \right)\]</span>One of the results is that for <em>n</em> large enough, we might approximate the binomial probabilities using the normal distribution. We denote this type of approximative distribution using a double-wave symbol <span class="math inline">\(\approx\)</span>:</p>
<p><span class="math display">\[
\sum_{i=1}^nX_i \approx N\left(n\pi, \sqrt{n\pi(1-\pi)}  \right)
\]</span></p>
<p><span class="math display">\[
P_n\approx N \left(\pi,\sqrt{\frac{\pi(1- \pi)}{n}}  \right)
\]</span></p>
<section id="continuity-correction" class="level4">
<h4 class="anchored" data-anchor-id="continuity-correction">Continuity correction</h4>
<p>Approximating binomial distribution, which is integer-valued, with a continuous normal distribution, might pose an interesting problem. This problem arises with a question formulation: for binomial distribution, the question of what is the probability of being less or equal to <em>x</em> is the same as the question of what is the probability of being less than <em>x</em>+1; for normal distribution, however, these are two different questions because there is now a probability between <em>x</em> and <em>x</em>+1.</p>
<p><span class="math display">\[
Bi:P(X\leq x)=P(X&lt;x+1)
\]</span></p>
<p><span class="math display">\[ N:F(x)\neq F(x+1) \]</span></p>
<p>The solution to this problem is straightforward: when the question is about less or equal, we add 1/2; when the question is about less, we subtract 1/2. By this operation, we get the same result no matter how the question is posed:</p>
<p><span class="math display">\[
N+CC:F(x+0.5)=F(x+1-0.5)
\]</span></p>
<p>This is called continuity correction and is applicable any time we want to approximate an integer-valued random variable with a continuous one. If the random variable is discrete but not an integer-valued, we want to meet half the distance between the two values.</p>
<p>This applies, for example, to the means of discrete variables (and relative frequency as well), where we can derive continuity correction this way:</p>
<p><span class="math display">\[\frac{\sum_{i=1}^n X_i \pm1/2}{n}=\overline{X} \pm\frac{1}{2n}\]</span></p>
</section>
</section>
<section id="lindenberg-lévy-central-limit-theorem" class="level3">
<h3 class="anchored" data-anchor-id="lindenberg-lévy-central-limit-theorem">Lindenberg-Lévy central limit theorem</h3>
<p>Similarly, as Knichin´s law is a generalisation of Bernoulli´s law, Lindenberg-Lévy’s theorem generalises the de Moivre-Laplace theorem.</p>
<p>Let <span class="math inline">\(X_1,X_2,...,X_n\)</span> be a sequence of independent identically distributed random variables with any distribution with finite variance, <span class="math inline">\(X_i\sim ?(E(X),Var(X))\)</span>.</p>
<p>Let a sequence of summations be calculated from these random variables, that is, <span class="math inline">\(M_n=\sum_{i=1}^{n}(X_i)\)</span>. This sequence convergences in distribution to the normal distribution:</p>
<p><span class="math display">\[
M_n \xrightarrow{n\to\infty;D}N\left(nE(X),\sqrt{nVar(X)}\right)
\]</span></p>
<p>And by linear transformation, the sequence of arithmetic means also converges to the normal distribution:</p>
<p><span class="math display">\[\overline{X_n}=\frac{\sum_{i=1}^n X_i}{n} \xrightarrow{n\to\infty;D}N\left(E(X),\sqrt{\frac{Var(X)}{n}}\right)\]</span>One of the results is that for <em>n</em> large enough, we might use a normal distribution to calculate probabilities of sample means. Again, the approximation notation is commonly used:</p>
<p><span class="math display">\[ M_n \approx N\left(nE(X),\sqrt{nVar(X)}\right) \]</span></p>
<p><span class="math display">\[\overline{X_n}\approx N\left(E(X),\sqrt{\frac{Var(X)}{n}}\right)\]</span></p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>